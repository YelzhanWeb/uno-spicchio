<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>UNO Spicchio - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <!-- Material Symbols (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ç–µ–∫—Å—Ç–∞ –≤–º–µ—Å—Ç–æ –∏–∫–æ–Ω–æ–∫) -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#E53935",
                        "background-light": "#F8F7F5",
                        "background-dark": "#121212",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                    },
                },
            },
        };
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
        }
    </style>
</head>

<body class="font-display bg-background-light dark:bg-background-dark text-gray-900 dark:text-gray-100">
    <div class="flex h-screen">
        <!-- SIDEBAR -->
        <aside
            class="w-64 flex-shrink-0 bg-white dark:bg-gray-800 p-6 border-r border-gray-200 dark:border-gray-700 flex flex-col">
            <div class="mb-10">
                <h1 class="text-xl font-bold text-gray-900 dark:text-white">UNO Spicchio</h1>
            </div>

            <!-- –í–ö–õ–ê–î–ö–ò -->
            <nav class="flex flex-col space-y-2 flex-1">
                <div class="px-4 py-3 bg-red-50 dark:bg-gray-700 rounded-lg">
                    <p class="font-semibold text-primary">UNO Spicchio</p>
                </div>

                <!-- –í—Å–µ –∑–∞–∫–∞–∑—ã -->
                <a href="active-orders.html"
                    class="flex items-center gap-2 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined">receipt_long</span>
                    <span>–í—Å–µ –∑–∞–∫–∞–∑—ã</span>
                </a>

                <!-- –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (–∞–∫—Ç–∏–≤–Ω–∞—è) -->
                <a id="createOrderLink" href="create-order.html"
                    class="flex items-center gap-2 px-4 py-3 bg-red-100/50 dark:bg-gray-700/50 rounded-lg font-medium text-gray-900 dark:text-white">
                    <span class="material-symbols-outlined">add_shopping_cart</span>
                    <span>–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</span>
                </a>

                <!-- –ö—É—Ö–Ω—è -->
                <a id="chefLink" href="chef-orders.html"
                    class="flex items-center gap-2 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined">restaurant</span>
                    <span>–ö—É—Ö–Ω—è</span>
                </a>

                <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <a id="dashboardLink" href="dashboard.html"
                    class="flex items-center gap-2 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined">analytics</span>
                    <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                </a>
            </nav>

            <!-- –ù–∏–∑ —Å–∞–π–¥–±–∞—Ä–∞ -->
            <div class="mt-6">
                <div class="border-t border-gray-200 dark:border-gray-700 pt-3 space-y-2 text-sm">
                    <a href="#"
                        class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="material-symbols-outlined text-xl">help</span>
                        <span>Help</span>
                    </a>
                    <a href="#" onclick="logout(); return false;"
                        class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="material-symbols-outlined text-xl">logout</span>
                        <span>Log Out</span>
                    </a>
                </div>
            </div>
        </aside>

        <!-- MAIN -->
        <main class="flex-1 overflow-y-auto p-8">
            <!-- THEME TOGGLE BUTTON -->
            <div class="flex justify-end mb-6">
                <button id="theme-toggle"
                    class="flex items-center gap-2 px-4 py-2 rounded-lg bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 text-gray-800 dark:text-gray-100 shadow hover:bg-gray-100 dark:hover:bg-zinc-700 transition">
                    <span class="material-symbols-outlined">light_mode</span>
                    <span id="theme-toggle-text">Light</span>
                </button>
            </div>

            <div class="max-w-7xl mx-auto grid grid-cols-3 gap-8">
                <!-- LEFT: TABLE + MENU (2 columns) -->
                <div class="col-span-2 flex flex-col">
                    <h1 class="text-3xl font-bold mb-8 text-gray-900 dark:text-white">
                        Create New Order
                    </h1>

                    <!-- Top controls: Select table + Search -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- Select table -->
                        <div>
                            <label for="table-select"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Select
                                Table</label>
                            <div class="relative">
                                <select id="table-select"
                                    class="w-full pl-4 pr-10 py-3 text-sm border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 focus:ring-primary focus:border-primary appearance-none">
                                    <option value="">Loading tables...</option>
                                </select>
                                <div
                                    class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-400">
                                    <span class="material-symbols-outlined text-xl">
                                        expand_more
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Search menu -->
                        <div>
                            <label for="menu-search"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 invisible">Search</label>
                            <div class="relative">
                                <span
                                    class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500">search</span>
                                <input id="menu-search" type="text" placeholder="Search menu items..."
                                    class="w-full pl-12 pr-4 py-3 text-sm border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 focus:ring-primary focus:border-primary" />
                            </div>
                        </div>
                    </div>

                    <!-- Tabs (categories) -->
                    <div class="border-b border-gray-200 dark:border-zinc-700 mb-6 overflow-x-auto">
                        <nav id="menu-tabs-container" aria-label="Tabs" class="flex space-x-8 -mb-px">
                            <!-- JS will render tabs here -->
                        </nav>
                    </div>

                    <!-- Menu items grid -->
                    <div id="menu-items-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- JS will render dish cards here -->
                    </div>
                </div>

                <!-- RIGHT: CURRENT ORDER (1 column) -->
                <div class="col-span-1">
                    <div
                        class="sticky top-8 bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-lg p-6 flex flex-col">
                        <h2 class="text-xl font-bold mb-6 text-gray-900 dark:text-white">
                            Current Order
                        </h2>

                        <!-- Order items -->
                        <div id="order-items-container" class="flex flex-col">
                            <div class="text-center py-12">
                                <h3 class="font-semibold text-gray-800 dark:text-white mb-1">
                                    No items added yet
                                </h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    Select items from the menu to add them to this order.
                                </p>
                            </div>
                        </div>

                        <!-- Totals -->
                        <div class="border-t border-gray-200 dark:border-zinc-700 pt-4 mt-4 space-y-4">
                            <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400">
                                <span>Subtotal</span>
                                <span id="order-subtotal">‚Ç∏0.00</span>
                            </div>
                            <div class="flex justify-between font-bold text-lg text-gray-900 dark:text-white">
                                <span>Total</span>
                                <span id="order-total">‚Ç∏0.00</span>
                            </div>
                        </div>

                        <!-- Create order button -->
                        <button id="create-order-btn" type="button"
                            class="w-full bg-primary text-white font-semibold py-3.5 rounded-lg mt-6 text-sm hover:bg-red-700 transition-colors disabled:opacity-50">
                            CREATE ORDER
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- JS LOGIC (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
    <script>
        const API_BASE_URL = "http://localhost:8080/api";
        let menuData = [];
        let currentOrder = { items: new Map() };
        let activeCategoryId = null;
        let currentUser = null;
        let tables = [];
        let menuSearchTerm = "";

        const menuTabsContainer = document.getElementById("menu-tabs-container");
        const menuItemsContainer = document.getElementById("menu-items-container");
        const orderItemsContainer = document.getElementById("order-items-container");
        const orderSubtotalEl = document.getElementById("order-subtotal");
        const orderTotalEl = document.getElementById("order-total");
        const createOrderBtn = document.getElementById("create-order-btn");
        const tableSelect = document.getElementById("table-select");
        const menuSearchInput = document.getElementById("menu-search");

        function checkAuth() {
            const token = localStorage.getItem("auth_token");
            if (!token) {
                window.location.href = "login.html";
                return false;
            }
            return token;
        }

        async function loadUserData() {
            const token = checkAuth();
            if (!token) return;

            try {
                const response = await fetch(`${API_BASE_URL}/auth/me`, {
                    headers: { Authorization: `Bearer ${token}` },
                });

                if (response.ok) {
                    const result = await response.json();

                    if (result.success && result.data) {
                        currentUser = result.data;
                    } else if (result.id) {
                        currentUser = result;
                    }

                    if (currentUser) {
                        if (currentUser.role !== "waiter" && currentUser.role !== "admin") {
                            alert("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤");
                            window.location.href = "active-orders.html";
                        }
                    }
                } else {
                    logout();
                }
            } catch (error) {
                console.error("Error loading user data:", error);
                logout();
            }
        }

        function logout() {
            localStorage.removeItem("auth_token");
            localStorage.removeItem("user_data");
            window.location.href = "login.html";
        }

        async function loadTables() {
            const token = checkAuth();
            if (!token) return;

            try {
                const response = await fetch(`${API_BASE_URL}/tables`, {
                    headers: { Authorization: `Bearer ${token}` },
                });

                if (response.ok) {
                    const result = await response.json();

                    if (result.success && result.data) {
                        tables = result.data;
                    } else if (Array.isArray(result)) {
                        tables = result;
                    } else {
                        tables = [];
                    }

                    tableSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–æ–ª</option>';
                    tables.forEach((table) => {
                        const option = document.createElement("option");
                        option.value = table.id;
                        let statusText =
                            table.status === "free"
                                ? "üü¢ –°–≤–æ–±–æ–¥–µ–Ω"
                                : table.status === "reserve"
                                    ? "üü° –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω"
                                    : "üî¥ –ó–∞–Ω—è—Ç";
                        option.textContent = `${table.name} - ${statusText}`;
                        option.disabled = table.status === "busy";
                        tableSelect.appendChild(option);
                    });
                } else {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–æ–ª–æ–≤");
                }
            } catch (error) {
                console.error("Error loading tables:", error);
            }
        }

        async function loadMenu() {
            const token = checkAuth();
            if (!token) return;

            try {
                const categoriesResponse = await fetch(
                    `${API_BASE_URL}/categories`,
                    {
                        headers: { Authorization: `Bearer ${token}` },
                    }
                );

                if (!categoriesResponse.ok) {
                    throw new Error("Failed to load categories");
                }

                const categoriesResult = await categoriesResponse.json();
                let categories;

                if (categoriesResult.success && categoriesResult.data) {
                    categories = categoriesResult.data;
                } else if (Array.isArray(categoriesResult)) {
                    categories = categoriesResult;
                } else {
                    categories = [];
                }

                const dishesResponse = await fetch(
                    `${API_BASE_URL}/dishes?active=true`,
                    {
                        headers: { Authorization: `Bearer ${token}` },
                    }
                );

                if (!dishesResponse.ok) {
                    throw new Error("Failed to load dishes");
                }

                const dishesResult = await dishesResponse.json();
                let dishes;

                if (dishesResult.success && dishesResult.data) {
                    dishes = dishesResult.data;
                } else if (Array.isArray(dishesResult)) {
                    dishes = dishesResult;
                } else {
                    dishes = [];
                }

                menuData = categories.map((category) => ({
                    id: category.id,
                    name: category.name,
                    dishes: dishes.filter(
                        (dish) => dish.category_id === category.id && dish.is_active
                    ),
                }));

                if (menuData.length > 0) {
                    activeCategoryId = menuData[0].id;
                    renderTabs();
                    renderMenu();
                } else {
                    menuItemsContainer.innerHTML =
                        '<p class="text-gray-500 p-4">–ú–µ–Ω—é –ø—É—Å—Ç–æ.</p>';
                }
            } catch (error) {
                console.error("Error loading menu:", error);
                menuItemsContainer.innerHTML =
                    '<p class="text-red-500 p-4">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é.</p>';
            }
        }

        function renderTabs() {
            menuTabsContainer.innerHTML = "";
            menuData.forEach((category) => {
                const isActive = category.id === activeCategoryId;
                const tab = document.createElement("a");
                tab.href = "#";
                tab.className =
                    "py-3 px-1 text-sm font-semibold border-b-2 whitespace-nowrap " +
                    (isActive
                        ? "border-primary text-primary"
                        : "text-gray-500 dark:text-gray-400 border-transparent hover:text-gray-700 dark:hover:text-gray-200 hover:border-gray-300 dark:hover:border-zinc-600");
                tab.textContent = category.name;
                tab.addEventListener("click", (e) => {
                    e.preventDefault();
                    activeCategoryId = category.id;
                    renderTabs();
                    renderMenu();
                });
                menuTabsContainer.appendChild(tab);
            });
        }

        function renderMenu() {
            menuItemsContainer.innerHTML = "";
            const activeCategory = menuData.find(
                (c) => c.id === activeCategoryId
            );
            if (!activeCategory || !activeCategory.dishes || activeCategory.dishes.length === 0) {
                menuItemsContainer.innerHTML =
                    '<p class="text-gray-500 p-4">–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –±–ª—é–¥.</p>';
                return;
            }

            const dishesToRender = activeCategory.dishes.filter((dish) => {
                if (!menuSearchTerm) return true;
                const text = `${dish.name} ${dish.description || ""}`.toLowerCase();
                return text.includes(menuSearchTerm);
            });

            if (dishesToRender.length === 0) {
                menuItemsContainer.innerHTML =
                    '<p class="text-gray-500 p-4">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É.</p>';
                return;
            }

            dishesToRender.forEach((dish) => {
                const card = document.createElement("div");
                card.className =
                    "bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-lg p-4 flex flex-col";

                const imageUrl = dish.image_url || "";
                const hasImage = Boolean(imageUrl);

                card.innerHTML = `
            ${hasImage
                        ? `<img class="w-full h-40 object-cover rounded-md mb-3" src="${imageUrl}" alt="${dish.name}" />`
                        : ""
                    }
            <div class="flex-grow mb-4">
              <h3 class="font-semibold text-gray-800 dark:text-white">${dish.name}</h3>
              <p class="text-sm text-gray-500 dark:text-gray-400">${dish.description || ""}</p>
            </div>
            <div class="flex items-center justify-between">
              <span class="font-bold text-gray-900 dark:text-white">‚Ç∏${dish.price.toFixed(2)}</span>
              <button
                class="add-dish-btn bg-red-100 dark:bg-primary/20 text-primary font-semibold text-sm px-5 py-2 rounded-lg hover:bg-red-200 dark:hover:bg-primary/30 transition-colors"
              >
                Add
              </button>
            </div>
          `;

                card
                    .querySelector(".add-dish-btn")
                    .addEventListener("click", () => addToOrder(dish));

                menuItemsContainer.appendChild(card);
            });
        }

        function renderCurrentOrder() {
            orderItemsContainer.innerHTML = "";

            if (currentOrder.items.size === 0) {
                orderItemsContainer.innerHTML = `
            <div class="text-center py-12">
              <h3 class="font-semibold text-gray-800 dark:text-white mb-1">
                No items added yet
              </h3>
              <p class="text-sm text-gray-500 dark:text-gray-400">
                Select items from the menu to add them to this order.
              </p>
            </div>
          `;
                updateTotals();
                return;
            }

            currentOrder.items.forEach((item) => {
                const row = document.createElement("div");
                row.className =
                    "flex items-center justify-between py-2 border-b border-gray-200 dark:border-zinc-700 last:border-b-0";

                const itemTotal = item.price * item.quantity;

                row.innerHTML = `
            <div class="flex flex-col">
              <p class="text-sm font-medium text-gray-900 dark:text-white">${item.name}</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                –¶–µ–Ω–∞: ‚Ç∏${item.price.toFixed(2)}
              </p>
            </div>
            <div class="flex items-center gap-4">
              <div class="flex items-center justify-center gap-2">
                <button class="decrement-btn text-lg font-bold text-red-500 hover:text-red-700">-</button>
                <span class="min-w-[20px] text-center text-sm">${item.quantity}</span>
                <button class="increment-btn text-lg font-bold text-green-500 hover:text-green-700">+</button>
              </div>
              <p class="text-sm font-semibold text-gray-900 dark:text-white">
                ‚Ç∏${itemTotal.toFixed(2)}
              </p>
            </div>
          `;

                row
                    .querySelector(".decrement-btn")
                    .addEventListener("click", () => decrementItem(item.dish_id));
                row
                    .querySelector(".increment-btn")
                    .addEventListener("click", () => incrementItem(item.dish_id));

                orderItemsContainer.appendChild(row);
            });

            updateTotals();
        }

        function updateTotals() {
            let subtotal = 0;
            currentOrder.items.forEach((item) => {
                subtotal += item.price * item.quantity;
            });
            orderSubtotalEl.textContent = `‚Ç∏${subtotal.toFixed(2)}`;
            orderTotalEl.textContent = `‚Ç∏${subtotal.toFixed(2)}`;
        }

        function addToOrder(dish) {
            if (currentOrder.items.has(dish.id)) {
                incrementItem(dish.id);
            } else {
                currentOrder.items.set(dish.id, {
                    dish_id: dish.id,
                    name: dish.name,
                    price: dish.price,
                    quantity: 1,
                });
            }
            renderCurrentOrder();
        }

        function incrementItem(dishId) {
            if (currentOrder.items.has(dishId)) {
                currentOrder.items.get(dishId).quantity++;
                renderCurrentOrder();
            }
        }

        function decrementItem(dishId) {
            if (currentOrder.items.has(dishId)) {
                const item = currentOrder.items.get(dishId);
                item.quantity--;
                if (item.quantity === 0) {
                    currentOrder.items.delete(dishId);
                }
                renderCurrentOrder();
            }
        }

        async function submitOrder() {
            if (currentOrder.items.size === 0) {
                alert("–ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π –∑–∞–∫–∞–∑.");
                return;
            }

            const tableNumber = parseInt(tableSelect.value);
            if (!tableNumber) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–æ–ª.");
                return;
            }

            const token = checkAuth();
            if (!token) return;

            const payload = {
                table_number: tableNumber,
                notes: null,
                items: Array.from(currentOrder.items.values()).map((item) => ({
                    dish_id: item.dish_id,
                    qty: item.quantity,
                    notes: null,
                })),
            };

            console.log("Sending order:", payload);

            createOrderBtn.disabled = true;
            createOrderBtn.textContent = "–°–æ–∑–¥–∞–Ω–∏–µ...";

            try {
                const response = await fetch(`${API_BASE_URL}/orders`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        Authorization: `Bearer ${token}`,
                    },
                    body: JSON.stringify(payload),
                });

                if (response.ok) {
                    alert("–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!");
                    window.location.href = "active-orders.html";
                } else {
                    const errorData = await response.json();
                    alert(
                        "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞: " +
                        (errorData.error || response.statusText)
                    );
                    createOrderBtn.disabled = false;
                    createOrderBtn.textContent = "CREATE ORDER";
                }
            } catch (error) {
                alert("–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞. –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑.");
                console.error(error);
                createOrderBtn.disabled = false;
                createOrderBtn.textContent = "CREATE ORDER";
            }
        }

        createOrderBtn.addEventListener("click", submitOrder);

        if (menuSearchInput) {
            menuSearchInput.addEventListener("input", (e) => {
                menuSearchTerm = e.target.value.toLowerCase();
                renderMenu();
            });
        }

        document.addEventListener("DOMContentLoaded", async () => {
            await loadUserData();
            await loadTables();
            await loadMenu();
            renderCurrentOrder();
        });
    </script>

    <!-- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã -->
    <script>
        const themeToggleBtn = document.getElementById("theme-toggle");
        const themeToggleText = document.getElementById("theme-toggle-text");
        const themeIcon = themeToggleBtn.querySelector(".material-symbols-outlined");

        // Default theme = light
        if (!localStorage.getItem("theme")) {
            localStorage.setItem("theme", "light");
        }

        // Apply saved theme
        if (localStorage.getItem("theme") === "dark") {
            document.documentElement.classList.add("dark");
            themeToggleText.textContent = "Dark";
            themeIcon.textContent = "dark_mode";
        }

        themeToggleBtn.addEventListener("click", () => {
            const isDark = document.documentElement.classList.contains("dark");

            if (isDark) {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("theme", "light");
                themeToggleText.textContent = "Light";
                themeIcon.textContent = "light_mode";
            } else {
                document.documentElement.classList.add("dark");
                localStorage.setItem("theme", "dark");
                themeToggleText.textContent = "Dark";
                themeIcon.textContent = "dark_mode";
            }
        });
    </script>
</body>

</html>